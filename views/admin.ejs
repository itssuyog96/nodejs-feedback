<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<% include tpl/header.ejs %>
<link href="stylesheets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css"/>
<link href="stylesheets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet"
      type="text/css"/>

<body class="page-header-fixed page-sidebar-closed-hide-logo page-container-bg-solid">
<!-- BEGIN HEADER -->

<% include tpl/menu.ejs %>

<!-- END HEADER -->


<!-- BEGIN HEADER & CONTENT DIVIDER -->
<div class="clearfix"></div>
<!-- END HEADER & CONTENT DIVIDER -->

<!-- BEGIN CONTAINER -->
<div class="page-container">
    <% include tpl/sidebar.ejs %>
    <!-- BEGIN CONTENT -->
    <div class="page-content-wrapper">
        <!-- BEGIN CONTENT BODY -->
        <div class="page-content">
            <!-- BEGIN PAGE HEADER-->

            <!--h3 class="page-title"> Blank Page Layout
                <small>blank page layout</small>        To be resolved
            </h3-->

            <!-- END PAGE HEADER-->


            <!--START EDITING FROM HERE-->

            <div class="m-heading-1 border-green m-bordered">
                <h3>Data Entry Hub</h3>
                <p> All types of entries are done here. </p>
                <p> Start from selecting department in college table.
                    <a class="btn red btn-outline" href="#" target="_blank">for admins to enter college</a>
                </p>
            </div>

            <div class="portlet light div-<%= col.name %>">
                <div class="portlet-title">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase"> College Table</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12">
                            <table id="<%= col.name %>"
                                   class="table table-striped table-bordered table-hover table-checkable order-column">
                                <thead>
                                <tr>
                                    <% col.columns.forEach(function (items) { %>
                                    <th><%= items %></th>
                                    <% }); %>
                                </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="portlet light div-<%= dept.name %>">
                <div class="portlet-title">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase">Department Table</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12">
                            <table id="<%= dept.name %>"
                                   class="table table-striped table-bordered table-hover table-checkable order-column">
                                <thead>
                                <tr>
                                    <% dept.columns.forEach(function (items) { %>
                                    <th><%= items %></th>
                                    <% }); %>
                                </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="portlet light  div-<%= profs.name %>">
                <div class="portlet-title">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase">Professor Table</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12">
                            <table id="<%= profs.name %>"
                                   class="table table-striped table-bordered table-hover table-checkable order-column">
                                <thead>
                                <tr>
                                    <% profs.columns.forEach(function (items) { %>
                                    <th><%= items %></th>
                                    <% }); %>
                                </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="portlet light div-<%= subj.name %>">
                <div class="portlet-title">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase">Subject Table</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12">
                            <table id="<%= subj.name %>"
                                   class="table table-striped table-bordered table-hover table-checkable order-column">
                                <thead>
                                <tr>
                                    <% subj.columns.forEach(function (items) { %>
                                    <th><%= items %></th>
                                    <% }); %>
                                </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!--STOP EDITING HERE-->

        </div>
        <!-- END CONTENT BODY -->
    </div>
    <!-- END CONTENT -->
    <% include tpl/quicksidebar.ejs %>
</div>

<!-- END CONTAINER -->

<% include tpl/footer.ejs %>
<script src="javascripts/global/scripts/datatable.js" type="text/javascript"></script>
<script src="javascripts/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>
<script src="javascripts/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js"
        type="text/javascript"></script>

<script>

    $(".div-<%= dept.name %>").css("display", "none");
    $(".div-<%= profs.name %>").css("display", "none");
    $(".div-<%= subj.name %>").css("display", "none");

    function load_<%= col.name %>() {
        var i = 1;
        $("#<%= col.name %>").DataTable().destroy();
        $("#<%= col.name %>").DataTable({
            ajax: 'ajax/load_colg',
            columns: [
                {data: "col_id"},
                <% col.column_data.forEach(function(item){ %>
                {data: "<%= item %>"},
                <% }) %>
                {
                    data: function (data) {
                        var dept_btn = '<a class="btn blue btn-outline" href="javascript:load_<%= dept.name %>(' + data.<%= col.column_data[0] %>+ ')" target="_blank">DEPARTMENTS</a>';
                        var del_btn = '<a class="btn red btn-outline" href="javascript:del_colg(' + data.<%= col.column_data[0] %>+ ')" target="_blank">DELETE</a>';

                        var btns = dept_btn + " " + del_btn;

                        return btns;
                    }
                }
            ]
        });
    }

    load_<%= col.name %>();


    function load_<%= dept.name %>(id) {
        var i = 1;
        $("#<%= dept.name %>").DataTable().destroy();
        $("#<%= dept.name %>").DataTable({
            ajax: {
                url: 'ajax/dept_list',
                data: {id: id},
                method: 'POST'
            },
            columns: [
                i++,
                <% dept.column_data.forEach(function(item){ %>
                {data: <%= item %>},
                <% }) %>
                {
                    data: function (data) {
                        var profs_btn = '<a class="btn blue btn-outline" href="javascript:load_<%= profs.name %>(' + data.<%= dept.column_data[0] %>+ ')" target="_blank">DEPARTMENTS</a>';
                        var subj_btn = '<a class="btn blue btn-outline" href="javascript:load_<%= subj.name %>(' + data.<%= dept.column_data[0] %>+ ')" target="_blank">DEPARTMENTS</a>';
                        var del_btn = '<a class="btn blue btn-outline" href="javascript:del_dept(' + data.<%= dept.column_data[0] %>+ ')" target="_blank">DELETE</a>';

                        var btns = profs_btn + '&amp;&amp;' + subj_btn + '$amp;&amp;' + del_btn;

                        return btns;
                    }
                }
            ]

        });
    }

    function load_<%= subj.name %>(id) {
        var i = 1;
        $("#<%= subj.name %>").DataTable().destroy();
        $("#<%= subj.name %>").DataTable({
            ajax: {
                url: 'ajax/subj_list',
                data: {id: id},
                method: 'POST'
            },
            columns: [
                i++,
                <% subj.column_data.forEach(function(item){ %>
                {data: <%= item %>},
                <% }) %>
                {
                    data: function (data) {
                        var del_btn = '<a class="btn red btn-outline" href="javascript:del_subj(' + data.<%= subj.column_data[0] %>+ ')" target="_blank">DELETE</a>';

                        var btns = del_btn;

                        return btns;
                    }
                }
            ]

        });
    }

    function load_<%= profs.name %>(id) {
        var i = 1;
        $("#<%= profs.name %>").DataTable().destroy();
        $("#<%= profs.name %>").DataTable({
            ajax: {
                url: 'ajax/profs_list',
                data: {id: id},
                method: 'POST'
            },
            columns: [
                i++,
                <% profs.column_data.forEach(function(item){ %>
                {data: <%= item %>},
                <% }) %>
                {
                    data: function (data) {
                        var del_btn = '<a class="btn red btn-outline" href="javascript:del_profs(' + data.<%= profs.column_data[0] %>+ ')" target="_blank">DELETE</a>';

                        var btns = del_btn;

                        return btns;
                    }
                }
            ]

        });
    }

    function del_colg(id) {
        $.ajax({
            url: 'ajax/del_colg',
            data: {id: id},
            method: 'POST',
            success: function (data) {
                load_<%= col.name %>();
                //toast the success message
            },
            error: function (data) {
                //toast the error out
            }
        });
    }

    function del_dept(id) {
        $.ajax({
            url: 'ajax/del_dept',
            data: {id: id},
            method: 'POST',
            success: function (data) {
                load_<%= col.name %>();
                //toast the success message
            },
            error: function (data) {
                //toast the error out
            }
        });
    }

    function del_subj(id) {
        $.ajax({
            url: 'ajax/del_subj',
            data: {id: id},
            method: 'POST',
            success: function (data) {
                load_<%= subj.name %>();
                //toast the success message
            },
            error: function (data) {
                //toast the error out
            }
        });
    }

    function del_dept(id) {
        $.ajax({
            url: 'ajax/del_dept',
            data: {id: id},
            method: 'POST',
            success: function (data) {
                load_<%= col.name %>();
                //toast the success message
            },
            error: function (data) {
                //toast the error out
            }
        });
    }


    $("#<%= profs.name %>").DataTable({});

    $("#<%= subj.name %>").DataTable({});
</script>

</body>

</html>